<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diablo Automatization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body,
        html {
            height: 100%;
            width: 100%;
            font-family: 'Verdana', sans-serif;
            color: white;
            overflow-y: auto;
        }

        body {
            background-image: url('diablo-photo.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .header {
            position: relative;
            margin: 20px;
            font-size: 2em;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
        }

        .formulas {
            margin: 20px;
            color: #ffffff;
        }

        .formula-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .formula-box {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
            display: none;
        }

        .formula-title {
            font-size: 1.5em;
            margin: 0;
            color: #ffffff;
            padding: 10px;
            background-color: rgba(128, 128, 128, 0.451);
            border-radius: 10px;
            cursor: pointer;
        }

        .formula-indicator {
            margin-right: 10px;
            color: #ffffff;
        }

        .input-group {
            margin-bottom: 10px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
        }

        .input-group select,
        .input-group input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: none;
            border-radius: 5px;
        }

        .add-btn,
        .calculate-btn,
        .remove-btn {
            display: inline-block;
            margin-top: 10px;
            padding: 10px 15px;
            background-color: #b35509;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 48%;
            margin-right: 2%;
        }

        .remove-btn {
            margin-right: 0;
        }

        .add-btn:hover,
        .calculate-btn:hover,
        .remove-btn:hover {
            background-color: #713410;
        }

        .result {
            margin-top: 20px;
            font-size: 1.2em;
        }

        .result-small {
            font-size: 0.9em;
            margin-top: 5px;
            line-height: 1.5;
        }

        /* –ú–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        @media (max-width: 600px) {
            .header {
                font-size: 1.5em;
                margin: 10px;
            }

            .formula-title {
                font-size: 1.2em;
            }

            .add-btn,
            .calculate-btn,
            .remove-btn {
                width: 100%;
                margin: 5px 0;
            }

            body {
                background-image: url('diablo-mobile-photo.jpg');
            }
        }
    </style>
</head>

<body>
    <div class="header">Diablo Automatization</div>
    <div class="formulas">
        <!-- –ü–µ—Ä–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞ -->
        <div class="formula-item" onclick="toggleFormula('formula-1')">
            <div class="formula-indicator">1)</div>
            <div class="formula-title">–ü—Ä–æ–¥–∞–∂–∞ üíç –ø–æ 5%</div>
        </div>
        <div id="formula-1" class="formula-box">
            <div class="input-group">
                <label for="level-1">–£—Ä–æ–≤–µ–Ω—å üíç:</label>
                <select id="level-1" name="level-1" class="level">
                    <option value="5">1 - 5</option>
                    <option value="10">6 - 10</option>
                    <option value="15">11 - 15</option>
                    <option value="20">16 - 20</option>
                    <option value="25">21 - 25</option>
                    <option value="30">26 - 30</option>
                    <option value="35">31 - 35</option>
                    <option value="40">36 - 40</option>
                    <option value="45">41 - 45</option>
                    <option value="50">46 - 50</option>
                    <option value="55">51 - 55</option>
                    <option value="60">56 - 60</option>
                    <option value="65">61 - 65</option>
                    <option value="66">66 - 69</option>
                    <option value="70">70</option>
                </select>
            </div>
            <div class="input-group">
                <label for="quantity-1">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ üíç:</label>
                <input type="number" id="quantity-1" name="quantity-1" class="quantity" min="1">
            </div>
            <div id="additional-inputs-1"></div>
            <button class="add-btn" onclick="addInputFields('additional-inputs-1')">+</button>
            <button class="remove-btn" onclick="removeInputFields('additional-inputs-1')">-</button>
            <button class="add-btn" onclick="addExtraInputFields('additional-inputs-1')">+üìô</button>
            <div class="input-group">
                <label for="guild-multiplier-1">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –≥–∏–ª—å–¥–∏–∏:</label>
                <select id="guild-multiplier-1" class="guild-multiplier">
                    <option value="1.0">1.0</option>
                    <option value="0.86">0.86</option>
                    <option value="0.91">0.91</option>
                    <option value="1.2">1.2</option>
                    <option value="1.36">1.36</option>
                    <option value="1.5">1.5</option>
                    <option value="1.72">1.72</option>
                </select>
                <label for="portal-multiplier-1">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ—Ä—Ç–∞–ª–∞:</label>
                <select id="portal-multiplier-1" class="portal-multiplier">
                    <option value="1.0">1.0</option>
                    <option value="1.5">1.5</option>
                    <option value="0.66">0.66</option>
                    <option value="0.44">0.44</option>
                </select>
            </div>
            <button class="calculate-btn" onclick="calculateTotal(1)">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
            <div id="result-1" class="result"></div>
        </div>

        <!-- –í—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º—É–ª–∞ -->
        <div class="formula-item" onclick="toggleFormula('formula-2')">
            <div class="formula-indicator">2)</div>
            <div class="formula-title">–ü—Ä–æ–¥–∞–∂–∞ üß©</div>
        </div>
        <div id="formula-2" class="formula-box">
            <div class="input-group">
                <label for="level-2">–£—Ä–æ–≤–µ–Ω—å üß©:</label>
                <select id="level-2" name="level-2" class="level">
                    <option value="5">1 - 5</option>
                    <option value="10">6 - 10</option>
                    <option value="15">11 - 15</option>
                    <option value="20">16 - 20</option>
                    <option value="25">21 - 25</option>
                    <option value="30">26 - 30</option>
                    <option value="35">31 - 35</option>
                    <option value="40">36 - 40</option>
                    <option value="45">41 - 45</option>
                    <option value="50">46 - 50</option>
                    <option value="55">51 - 55</option>
                    <option value="60">56 - 60</option>
                    <option value="65">61 - 65</option>
                    <option value="66">66 - 69</option>
                    <option value="70">70</option>
                </select>
            </div>
            <div class="input-group">
                <label for="quantity-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ üß©:</label>
                <input type="number" id="quantity-2" name="quantity-2" class="quantity" min="1">
            </div>
            <div id="additional-inputs-2"></div>
            <button class="add-btn" onclick="addInputFields('additional-inputs-2')">+</button>
            <button class="remove-btn" onclick="removeInputFields('additional-inputs-2')">-</button>
            <button class="add-btn" onclick="addExtraInputFields('additional-inputs-2')">+üìô</button>
            <div class="input-group">
                <label for="guild-multiplier-2">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –≥–∏–ª—å–¥–∏–∏:</label>
                <select id="guild-multiplier-2" class="guild-multiplier">
                    <option value="1.0">1.0</option>
                    <option value="0.7">0.7</option>
                    <option value="0.8">0.8</option>
                    <option value="1.4">1.4</option>
                    <option value="1.5">1.5</option>
                    <option value="2.0">2.0</option>
                </select>
                <label for="portal-multiplier-2">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ—Ä—Ç–∞–ª–∞:</label>
                <select id="portal-multiplier-2" class="portal-multiplier">
                    <option value="1.0">1.0</option>
                    <option value="1.5">1.5</option>
                    <option value="0.66">0.66</option>
                    <option value="0.44">0.44</option>
                </select>
            </div>
            <button class="calculate-btn" onclick="calculateTotal(2)">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
            <div id="result-2" class="result"></div>
        </div>

        <!-- –¢—Ä–µ—Ç—å—è —Ñ–æ—Ä–º—É–ª–∞ -->
        <div class="formula-item" onclick="toggleFormula('third-formula')">
            <div class="formula-indicator">3)</div>
            <div class="formula-title">–£—á—ë—Ç üìñ –∏ ‚è≥</div>
        </div>
        <div id="third-formula" class="formula-box" style="display: none;">
            <h3>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–µ –∏–º—è" /></h3>
            <div class="input-group">
                <button class="add-btn" onclick="restoreData()">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </div>
            <div id="data-table">
                <table>
                    <tr>
                        <td>üìñ:</td>
                        <td><input type="text" id="bookInput" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>‚è≥:</td>
                        <td><input type="text" id="hourglassInput" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ü–æ—Å–ª. —É–±–∏—Ç—ã–µ üíÄ:</td>
                        <td><input type="text" id="lastKilled1Input" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ü–æ—Å–ª. —É–±–∏—Ç—ã–µ ‚ò†Ô∏è:</td>
                        <td><input type="text" id="lastKilled2Input" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ò–∑–Ω. —É–±–∏—Ç—ã–µ üíÄ:</td>
                        <td><input type="text" id="incomingKilled1Input" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ò–∑–Ω. —É–±–∏—Ç—ã–µ ‚ò†Ô∏è:</td>
                        <td><input type="text" id="incomingKilled2Input" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–û–±—â–∏–µ —É–±–∏—Ç—ã–µ üíÄ:</td>
                        <td><input type="text" id="totalKilled1Input" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–û–±—â–∏–µ —É–±–∏—Ç—ã–µ ‚ò†Ô∏è:</td>
                        <td><input type="text" id="totalKilled2Input" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ü–æ—Å–ª. –≤–≤–æ–¥–Ω—ã–µ üíÄ:</td>
                        <td><input type="text" id="lastInput1" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ü–æ—Å–ª. –≤–≤–æ–¥–Ω—ã–µ ‚ò†Ô∏è:</td>
                        <td><input type="text" id="lastInput2" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ù–æ–≤—ã–µ –≤–≤–æ–¥–Ω—ã–µ üíÄ:</td>
                        <td><input type="text" id="newInputs1" class="input-field" disabled /></td>
                    </tr>
                    <tr>
                        <td>–ù–æ–≤—ã–µ –≤–≤–æ–¥–Ω—ã–µ ‚ò†Ô∏è:</td>
                        <td><input type="text" id="newInputs2" class="input-field" disabled /></td>
                    </tr>
                </table>
            <div class="input-group">
                <button class="add-btn" id="editButton" onclick="editData()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="add-btn" id="saveEditButton" style="display: none;" onclick="saveEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
            <div class="input-group">
                <label for="death1Input">üíÄ:</label>
                <input type="text" id="death1Input" class="input-field" />
            </div>
            <div class="input-group">
                <label for="death2Input">‚ò†Ô∏è:</label>
                <input type="text" id="death2Input" class="input-field" />
            </div>
            <div class="input-group">
                <label for="guild-multiplier-3">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –≥–∏–ª—å–¥–∏–∏:</label>
                <select id="guild-multiplier-3" class="guild-multiplier">
                    <option value="1.0">1.0</option>
                    <option value="0.7">0.7</option>
                    <option value="0.8">0.8</option>
                    <option value="1.4">1.4</option>
                    <option value="1.5">1.5</option>
                    <option value="2.0">2.0</option>
                </select>
            </div>
            <div class="input-group">
                <label for="portal-multiplier-3">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ—Ä—Ç–∞–ª–∞:</label>
                <select id="portal-multiplier-3" class="portal-multiplier">
                    <option value="1.0">1.0</option>
                    <option value="1.5">1.5</option>
                    <option value="0.66">0.66</option>
                    <option value="0.44">0.44</option>
                </select>
            </div>
            <div class="input-group">
                <button class="add-btn" onclick="executeCalculation()">–í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±—Å—á—ë—Ç</button>
                <button class="add-btn" onclick="saveData()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </div>
        </div>
    </div>

    <script>
        const priceTable1 = {
            5: 0.75, 10: 1.05, 15: 1.5, 20: 3, 25: 4.2,
            30: 6, 35: 9, 40: 18, 45: 27, 50: 42,
            55: 69, 60: 105, 61: 180, 62: 180, 63: 180, 64: 180, 65: 180, 66: 279, 67: 279, 68: 279, 69: 279, 70: 323
        };

        const priceTable2 = {
            5: 0.75, 10: 0.90, 15: 1.20, 20: 1.65, 25: 3,
            30: 6, 35: 8.4, 40: 13.8, 45: 19.5, 50: 33,
            55: 54, 60: 81, 61: 135, 62: 135, 63: 135, 64: 135, 65: 135, 66: 210, 70: 261
        };

        function toggleFormula(formulaId) {
            const formulaBox = document.getElementById(formulaId);
            formulaBox.style.display = formulaBox.style.display === 'block' ? 'none' : 'block';
        }

        function addInputFields(containerId) {
            const additionalInputs = document.getElementById(containerId);
            const inputFields = `
                <div class="input-group">
                    <label>–£—Ä–æ–≤–µ–Ω—å:</label>
                    <select class="level">
                        <option value="5">1 - 5</option>
                        <option value="10">6 - 10</option>
                        <option value="15">11 - 15</option>
                        <option value="20">16 - 20</option>
                        <option value="25">21 - 25</option>
                        <option value="30">26 - 30</option>
                        <option value="35">31 - 35</option>
                        <option value="40">36 - 40</option>
                        <option value="45">41 - 45</option>
                        <option value="50">46 - 50</option>
                        <option value="55">51 - 55</option>
                        <option value="60">56 - 60</option>
                        <option value="65">61 - 65</option>
                        <option value="66">66 - 69</option>
                        <option value="70">70</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                    <input type="number" class="quantity" min="1">
                </div>`;
            additionalInputs.insertAdjacentHTML('beforeend', inputFields);
        }

        function removeInputFields(containerId) {
            const additionalInputs = document.getElementById(containerId);
            if (additionalInputs.lastElementChild) {
                additionalInputs.removeChild(additionalInputs.lastElementChild);
                additionalInputs.removeChild(additionalInputs.lastElementChild);
            }
        }

        function calculateTotal(formulaNumber) {
            const quantities = document.querySelectorAll(`#formula-${formulaNumber} .quantity`);
            const levels = document.querySelectorAll(`#formula-${formulaNumber} .level`);

            console.log(`Quantities:`, quantities);
            console.log(`Levels:`, levels);

            let totalValue = 0;
            const levelTotals = {};

            for (let i = 0; i < quantities.length; i++) {
                const quantity = parseInt(quantities[i].value) || 0;
                const level = parseInt(levels[i].value) || 0;

                // –ò—Å–ø–æ–ª—å–∑—É–µ–º priceTable1 –¥–ª—è –ø–µ—Ä–≤–æ–π —Ñ–æ—Ä–º—É–ª—ã –∏ priceTable2 –¥–ª—è –≤—Ç–æ—Ä–æ–π
                const price = formulaNumber === 1 ? priceTable1[level] || 0 : priceTable2[level] || 0;

                const levelTotal = quantity * price;

                totalValue += levelTotal;
                if (level in levelTotals) {
                    levelTotals[level] += levelTotal;
                } else {
                    levelTotals[level] = levelTotal;
                }
            }

            function toggleFormula(formulaId) {
                const formulaBox = document.getElementById(formulaId);
                formulaBox.style.display = formulaBox.style.display === 'none' ? 'block' : 'none';
            }

            function editValues() {
                const inputs = document.querySelectorAll(`#${thirdFormulaId} input[type="number"]`);
                inputs.forEach(input => {
                    input.style.display = 'inline';
                    input.previousElementSibling.style.display = 'none';
                });
                document.getElementById('save-btn').style.display = 'inline';
                document.getElementById('cancel-btn').style.display = 'inline';
                document.getElementById('edit-btn').style.display = 'none';
            }

            function saveValues() {
                const inputs = document.querySelectorAll(`#${thirdFormulaId} input[type="number"]`);
                inputs.forEach(input => {
                    input.style.display = 'none';
                    input.previousElementSibling.innerText = input.value;
                    input.value = '';
                    input.previousElementSibling.style.display = 'inline';
                });
                document.getElementById('save-btn').style.display = 'none';
                document.getElementById('cancel-btn').style.display = 'none';
                document.getElementById('edit-btn').style.display = 'inline';
            }

            function cancelEdit() {
                const inputs = document.querySelectorAll(`#${thirdFormulaId} input[type="number"]`);
                inputs.forEach(input => {
                    input.style.display = 'none';
                    input.previousElementSibling.style.display = 'inline';
                });
                document.getElementById('save-btn').style.display = 'none';
                document.getElementById('cancel-btn').style.display = 'none';
                document.getElementById('edit-btn').style.display = 'inline';
            }

            function saveData() {
                const data = {
                    incomingKilled1: document.getElementById("incomingKilled1-input").value,
                    incomingKilled2: document.getElementById("incomingKilled2-input").value,
                    newInputs1: document.getElementById("newInputs1-input").value,
                    newInputs2: document.getElementById("newInputs2-input").value,
                    username: document.getElementById("username").value,
                    // Save other necessary data similarly
                };

                // Logic to save 'data' to the server
            }

            const multiplier = parseFloat(document.getElementById(`guild-multiplier-${formulaNumber}`).value) || 1;
            const portalmultiplier = parseFloat(document.getElementById(`portal-multiplier-${formulaNumber}`).value) || 1.0;
            const adjustedTotal = totalValue * multiplier * portalmultiplier;

            const resultElement = document.getElementById(`result-${formulaNumber}`);
            resultElement.innerHTML = `<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> ${formatCurrency(adjustedTotal)} (${adjustedTotal.toFixed(2)})`;

            Object.keys(levelTotals).forEach(level => {
                resultElement.innerHTML += `<div class="result-small">–≤–µ—â–∏ ${level} —É—Ä–æ–≤–Ω—è: ${formatCurrency(levelTotals[level])} (${levelTotals[level].toFixed(2)})</div>`;
            });
        }

        function formatCurrency(value) {
            let yens = Math.floor(value * 100) % 100;
            let med = Math.floor(value) % 100;
            let silver = Math.floor(value / 100) % 100;
            let gold = Math.floor(value / 10000);

            let currencyString = "";
            if (gold > 0) currencyString += `${gold}ü•á`;
            if (silver > 0) currencyString += `${silver}ü•à`;
            if (med > 0) currencyString += `${med}ü•â`;
            if (yens > 0) currencyString += `${yens}üÄÑ`;
            return currencyString;
        }
    </script>
    <script src="additionalItems.js"></script>
    <script src="additionalResources.js"></script>
    <script src="ThirdFormula.js"></script>
</body>

</html>
